<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NWFSC PNW Salmonid Viability Report Table and Figures — NWCTrends_report • NWCTrends</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="NWFSC PNW Salmonid Viability Report Table and Figures — NWCTrends_report"><meta property="og:description" content="This is the main function in the NWCTrends package which
creates the ESU tables and figures from the
Northwest Fisheries Science Center's Viability Report: &quot;2015 Status review
update for Pacific salmon and steelhead listed under the Endangered
Species Act: Pacific Northwest&quot;.
The 2015 NWFSC Viability Report can be viewed by typing
RShowDoc(&quot;2015_Status_Review_Update&quot;, package=&quot;NWCTrends&quot;)
at the command line. The report has a description of the
methods used for computing the smoothed trend lines and the status metrics.
A pdf of the methods is also available by typing
RShowDoc(&quot;Methods&quot;, package=&quot;NWCTrends&quot;)
at the command line."><meta property="og:image" content="https://nwfsc-math-bio.github.io/NWCTrends/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NWCTrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="https://github.com/nwfsc-math-bio/NWCTrends/releases/tag/v1.0" class="external-link">Version 1.0 2015 VR</a>
    </li>
    <li>
      <a href="https://github.com/nwfsc-math-bio/NWCTrends/releases/tag/v1.25" class="external-link">Version 1.25 2020 VR</a>
    </li>
    <li>
      <a href="https://github.com/nwfsc-math-bio/NWCTrends/releases/tag/v1.30" class="external-link">Version 1.30</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Viability PDFs

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../SR_2015.pdf">Viability Report 2015 (PDF)</a>
    </li>
    <li>
      <a href="../Methods.pdf">Methods (PDF)</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nwfsc-math-bio/NWCTrends/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>NWFSC PNW Salmonid Viability Report Table and Figures</h1>
    <small class="dont-index">Source: <a href="https://github.com/nwfsc-math-bio/NWCTrends/blob/HEAD/R/NWCTrends_report.R" class="external-link"><code>R/NWCTrends_report.R</code></a></small>
    <div class="hidden name"><code>NWCTrends_report.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function in the NWCTrends package which
creates the ESU tables and figures from the
Northwest Fisheries Science Center's Viability Report: "2015 Status review
update for Pacific salmon and steelhead listed under the Endangered
Species Act: Pacific Northwest".
The 2015 NWFSC Viability Report can be viewed by typing
<code>RShowDoc("2015_Status_Review_Update", package="NWCTrends")</code>
at the command line. The report has a description of the
methods used for computing the smoothed trend lines and the status metrics.
A pdf of the methods is also available by typing
<code>RShowDoc("Methods", package="NWCTrends")</code>
at the command line.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NWCTrends_report</span><span class="op">(</span></span>
<span>  inputfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.min.year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.max.year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="st">"identity"</span>, R <span class="op">=</span> <span class="st">"diagonal and equal"</span>, Q <span class="op">=</span> <span class="st">"equalvarcov"</span>, U <span class="op">=</span></span>
<span>    <span class="st">"unequal"</span><span class="op">)</span>,</span>
<span>  logit.fw <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fit.wild <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot.min.year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot.max.year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.data.points <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  geomean.table.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min.year <span class="op">=</span> <span class="fl">1990</span>, max.year <span class="op">=</span> <span class="fl">2014</span>, lenbands <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    min.band.points <span class="op">=</span> <span class="fl">2</span>, change.col <span class="op">=</span> <span class="st">"last.two"</span><span class="op">)</span>,</span>
<span>  trend.table.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year.ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1990</span><span class="op">:</span><span class="fl">2005</span>, <span class="fl">1999</span><span class="op">:</span><span class="fl">2014</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  output.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"html"</span>, <span class="st">"pdf"</span>, <span class="st">"word"</span><span class="op">)</span>,</span>
<span>  output.dir <span class="op">=</span> <span class="st">"NWCTrend_output"</span>,</span>
<span>  fit.all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.all.fracwild <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nwctrends.options <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-inputfile">inputfile<a class="anchor" aria-label="anchor" href="#arg-inputfile"></a></dt>
<dd><p>comma-delimited data file (see demo files for the format).
demofiles are in inst/extdata.</p></dd>


<dt id="arg-fit-min-year">fit.min.year<a class="anchor" aria-label="anchor" href="#arg-fit-min-year"></a></dt>
<dd><p>Optional. You can set the earliest year to use when fitting the models. If not passed in, then the min.year is the earliest year in the data file. This is used to fit to a subset of the full data set.</p></dd>


<dt id="arg-fit-max-year">fit.max.year<a class="anchor" aria-label="anchor" href="#arg-fit-max-year"></a></dt>
<dd><p>Optional. You can set the last year to use when fitting the models. If not passed in, then the max.year is the last year in the data file. This is used to use a subset of the full data set for fitting.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>The structure of the MARSS model to use. Entered as a list specified as a <a href="https://atsa-es.github.io/MARSS/reference/MARSS.html" class="external-link">MARSS</a> model.</p></dd>


<dt id="arg-logit-fw">logit.fw<a class="anchor" aria-label="anchor" href="#arg-logit-fw"></a></dt>
<dd><p>TRUE/FALSE whether to estimate the smoothed fraction wild from the logit of the fractions or from the raw (0,1) fractions.</p></dd>


<dt id="arg-fit-wild">fit.wild<a class="anchor" aria-label="anchor" href="#arg-fit-wild"></a></dt>
<dd><p>fit.wild=TRUE means to do the fit on fracwild*total versus on the total spawners. Note all the Viability Report analyses, use fit.wild=FALSE and the wild fit is total spawner fit x fracwild fit.</p></dd>


<dt id="arg-plot-min-year">plot.min.year<a class="anchor" aria-label="anchor" href="#arg-plot-min-year"></a></dt>
<dd><p>Optional. The earliest year to use when plotting the data if different than the first year in the data set.</p></dd>


<dt id="arg-plot-max-year">plot.max.year<a class="anchor" aria-label="anchor" href="#arg-plot-max-year"></a></dt>
<dd><p>Optional. The last year to use when plotting the data if different than the last year in the data set.</p></dd>


<dt id="arg-min-data-points">min.data.points<a class="anchor" aria-label="anchor" href="#arg-min-data-points"></a></dt>
<dd><p>The minimum data points to require from a population (for fitting and plotting).</p></dd>


<dt id="arg-geomean-table-control">geomean.table.control<a class="anchor" aria-label="anchor" href="#arg-geomean-table-control"></a></dt>
<dd><p>A list with the adjustable variables for geomean_table(). See ?geomean_table</p></dd>


<dt id="arg-trend-table-control">trend.table.control<a class="anchor" aria-label="anchor" href="#arg-trend-table-control"></a></dt>
<dd><p>A list with the adjustable variables for trend_15_table(). See <code><a href="trend_15_table.html">trend_15_table</a></code>. The year.ranges are the years for the multi-year trends. If any years are missing in the data set, then those trends will be blank.</p></dd>


<dt id="arg-output-type">output.type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>"html", "pdf", or "word" Format to produce the report in.</p></dd>


<dt id="arg-output-dir">output.dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>Directory (in the working directory) where the output will be saved. Defaults to "NWCTrend_output". The directory will be created if it does not exist.</p></dd>


<dt id="arg-fit-all">fit.all<a class="anchor" aria-label="anchor" href="#arg-fit-all"></a></dt>
<dd><p>If FALSE, then user can enter what ESUs to fun.</p></dd>


<dt id="arg-show-all-fracwild">show.all.fracwild<a class="anchor" aria-label="anchor" href="#arg-show-all-fracwild"></a></dt>
<dd><p>If FALSE, then the populations with no fracwild information are not shown on the fracwild plots.</p></dd>


<dt id="arg-nwctrends-options">nwctrends.options<a class="anchor" aria-label="anchor" href="#arg-nwctrends-options"></a></dt>
<dd><p>A list of plot options to change the appearance (colors, line types, line widths, point types, etc) in the plots. See <code><a href="nwctrends.options.html">nwctrends.options</a></code> for a description of the options.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Plots and tables that are saved to doc/figures/ESU_figures.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The default model used to fit the data is that used in the
2015 Status Update. This model uses information across the
populations in an ESU to estimate the process variance,
non-process variance (residuals
between smoothed fits and observed spawners), covariance in
process errors (good and bad year correlation). However it
allows each population to have a different trend.  This model is
specified as <code> model=list(Z="identity", R="diagonal and equal", U="unequal", Q="equalvarcov") </code>.</p>
<p>This function does all the steps to create the trend plots and figures</p><ol><li><p>Load data (.csv)</p></li>
<li><p>Fit model(s)</p></li>
<li><p>Make plots and tables and save as report</p></li>
</ol><p>By default, the plots and tables are saved in a directory
named (and created if necessary) NWCTrend_output in your
working directory.</p>
<p>The look of the tables can be adjusted by passing in <code>geomean.tables.control</code>. See <code>?geomean_tables</code>
for the elements that can be controlled. Note that if the defaults for
<code>geomean.table.control</code> are changed, they must be also changed in <code>geomean_tables.R</code>.</p>
<p>The look of the plots (line widths, types, colors, point types, etc) can be changed by passing in <code>nwctrends.options</code>. These
are passed in as a list, e.g. <code>nwctrends.options = list(main.total.col = "blue")</code>. See
<code><a href="nwctrends.options.html">nwctrends.options</a></code> for a list of the plot variables that can be changed.</p>
<p>See <code><a href="Status_trendfigure_multipanel.html">Status_trendfigure_multipanel</a></code> for details on the main plot of
smoothed total and wild spawners. See <code><a href="NWCTrends-package.html">NWCTrends</a></code> for a description of the package.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ford, M. J., K. Barnas, T. Cooney, L. G. Crozier, M. Diaz, J. J. Hard, E. E. Holmes, D. M. Holzer, R. G. Kope, P. W. Lawson, M. Liermann, J. M. Myers, M. Rowse, D. J. Teel, D. M. Van Doornik, T. C. Wainwright, L. A. Weitkamp, M. Williams. 2015. Status Review Update for Pacific Salmon and Steelhead Listed under the Endangered Species Act:  Pacific Northwest. Nationa Marine Fisheries Service, Northwest Fisheries Science Center.
Available from the NWFSC Publications page.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Eli Holmes, NOAA, Seattle, USA.  eli(dot)holmes(at)noaa(dot)gov</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example of the typical arguments that you will want to set</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nwfsc-math-bio.github.io/NWCTrends">NWCTrends</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">NWCTrends_report</span><span class="op">(</span>inputfile<span class="op">=</span><span class="st">"thedata.csv"</span>,</span></span>
<span class="r-in"><span>            fit.min.year<span class="op">=</span><span class="fl">1949</span>, fit.max.year <span class="op">=</span> <span class="fl">2019</span>,</span></span>
<span class="r-in"><span>            plot.min.year<span class="op">=</span><span class="fl">1980</span>, plot.max.year <span class="op">=</span> <span class="fl">2019</span>,</span></span>
<span class="r-in"><span>            geomean.table.control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                   min.year <span class="op">=</span> <span class="fl">1990</span>, max.year <span class="op">=</span> <span class="fl">2019</span>, lenbands <span class="op">=</span> <span class="fl">5</span>, </span></span>
<span class="r-in"><span>                   min.band.points <span class="op">=</span> <span class="fl">2</span>, change.col<span class="op">=</span><span class="st">"last.two"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            trend.table.control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                   year.ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1990</span><span class="op">:</span><span class="fl">2005</span>, <span class="fl">2004</span><span class="op">:</span><span class="fl">2019</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            output.type <span class="op">=</span> <span class="st">"word"</span>,</span></span>
<span class="r-in"><span>            output.dir <span class="op">=</span> <span class="st">"Output"</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="co"># Example of setting the plot variables to customize the look of the plots</span></span></span>
<span class="r-in"><span><span class="co"># Here the data points and wild line for the main plot are changed.</span></span></span>
<span class="r-in"><span><span class="fu">NWCTrends_report</span><span class="op">(</span>inputfile<span class="op">=</span><span class="st">"thedata.csv"</span>,</span></span>
<span class="r-in"><span>            nwctrends.options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main.raw.pch <span class="op">=</span> <span class="fl">1</span>, main.raw.col <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>                                     main.wild.lty <span class="op">=</span> <span class="fl">2</span>, main.wild.col <span class="op">=</span> <span class="st">"grey75"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Holmes Elizabeth.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

